<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">
        body {
            @apply text-[#1E1E1E] bg-[#F8F9FA];
        }
    </style>
</head>

<body>
    <div class="h-screen flex flex-col">
        <!-- HEADER -->
        <div class="h-[139px] flex items-center justify-between px-20">
            <!-- LOGO -->
            <h1 class="font-bold text-5xl text-[#1F7D53]">
                Logo
            </h1>

            <!-- NAVIGATION -->
            <div class="flex justify-between items-center gap-x-[97px]">
                <div class="flex justify-between gap-x-[21px]">
                    <a href="#" class="font-bold text-[#196442]">Beranda</a>
                    <a href="#">Donasi</a>
                    <a href="#">Tentang Kami</a>
                </div>

                <div class="flex justify-between gap-x-[21px] items-center">
                    <a href="#">Masuk</a>
                    <a href="#" class="bg-[#1F7D53] text-white rounded-xl px-5 py-3">Daftar</a>
                </div>
            </div>
        </div>

        <!-- HERO -->
        <div class="flex-1 relative">
            <div class="absolute h-full w-full inset-0 -z-10">
                <img src="./assets/images/donation-bg.png" class="h-full w-full" />
            </div>
            <div class="absolute h-full w-full inset-0 -z-5 bg-[#E9F2EE] opacity-88"></div>

            <div class="h-full w-full flex flex-col items-center justify-center gap-y-10">
                <h1 class="font-bold text-5xl">Mau berbagi apa hari ini?</h1>
                <img src="./assets/vectors/hero-1.png" />
                <p>Saatnya berbagi kebaikan dengan program-program di bawah ini</p>
            </div>
        </div>
    </div>

    <!-- DONATION SECTION -->
    <div class="px-20 py-14 space-y-10">
    <h1 class="text-5xl font-bold text-center">Daftar Semua Kampanye</h1>
        <div class="grid grid-cols-3 gap-10" id="all-campaigns">
            <!-- Campaign cards akan dimuat dari API -->
        </div>
        <div id="pagination" class="flex gap-2 justify-center mt-6"></div>
    </div>

    <!-- FOOTER -->
    <div class="bg-[#0B2C1D] px-20 py-14 space-y-16 text-white">
        <div class="flex justify-between">
            <div class="space-y-5">
                <h1 class="font-bold text-5xl text-[#1F7D53]">
                    Logo
                </h1>
                <p>Subscribe untuk mendapatkan info terbaru kami</p>
                <div class="rounded-full border border-white p-3 flex justify-between">
                    <input type="text" placeholder="Masukkan Email" class="flex-1">
                    <div class="size-7 flex items-center justify-center rounded-full bg-[#1F7D53]">
                        <img src="./assets/icons/arrow-right.png">
                    </div>
                </div>
            </div>

            <div class="gap-y-3 flex flex-col">
                <p>Dukungan</p>
                <a href="#" class="text-[#8E98A8]">FAQ & Privacy Policy</a>
                <a href="#" class="text-[#8E98A8]">Tentang</a>
                <a href="#" class="text-[#8E98A8]">Hubungi Kami</a>
                <a href="#" class="text-[#8E98A8]">Partner Kami</a>
            </div>
        </div>
        <p class="text-center">Â© 2025 Blockchain Donation Inc. Copyright and rights reserved</p>
    </div>

    <script>
        const campaignsContainer = document.getElementById("all-campaigns");
        const paginationContainer = document.getElementById("pagination");

        let currentPage = 1;
        const limitPerPage = 9;

        async function loadCampaigns(page = 1) {
            try {
            const res = await fetch(`/api/campaigns?page=${page}&limit=${limitPerPage}`);
            const data = await res.json();
            const { campaigns, totalPages } = data;

            campaignsContainer.innerHTML = "";
            renderPagination(page, totalPages);
            currentPage = page;

            if (campaigns.length === 0) {
                campaignsContainer.innerHTML = "<p class='col-span-3 text-center text-gray-500'>Belum ada kampanye.</p>";
                return;
            }

            campaigns.forEach(c => {
                const div = document.createElement("div");
                div.className = "rounded-xl bg-white flex flex-col";
                div.innerHTML = `
                <img src="${c.imageUrl || '/assets/images/donation-banner.png'}" class="rounded-t-xl" />
                <div class="p-4 space-y-3">
                    <h3 class="font-bold text-xl">${c.title}</h3>
                    <div class="flex gap-x-2 items-center">
                        <p class="text-[#8E98A8]">${c.organization ?? 'Lembaga Donasi'}</p>
                        <img src="/assets/vectors/verified.png" class="size-3">
                    </div>
                    <div class="flex gap-x-2">
                        <p class="font-bold text-xl text-[#1F7D53]">Rp. ${Number(c.collectedAmount).toLocaleString()}</p>
                        <p class="text-[#8E98A8]">Terkumpul</p>
                    </div>
                    <a href="/donation-detail.html?id=${c.id}" class="block w-min whitespace-nowrap bg-[#1F7D53] text-white rounded-xl px-5 py-3">Donasi</a>
                </div>
                `;
                campaignsContainer.appendChild(div);
            });

            // Render pagination buttons
            function renderPagination(currentPage, totalPages) {
                paginationContainer.innerHTML = "";

                // Tombol Previous
                const prevBtn = document.createElement("button");
                prevBtn.innerHTML = `<img src="./assets/icons/chev-l-grey.png" class="size-3 object-contain" />`;
                prevBtn.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                prevBtn.disabled = currentPage === 1;
                if (currentPage > 1) {
                    prevBtn.onclick = () => loadCampaigns(currentPage - 1);
                }
                paginationContainer.appendChild(prevBtn);

                // Fungsi bantu untuk membuat tombol
                const createPageBtn = (p) => {
                    const btn = document.createElement("button");
                    btn.textContent = p;
                    btn.className = `size-10 flex items-center justify-center rounded-xl ${
                        p === currentPage ? "bg-[#1F7D53] text-white" : "bg-white"
                    }`;
                    btn.onclick = () => loadCampaigns(p);
                    paginationContainer.appendChild(btn);
                };

                // Tampilkan halaman 1
                createPageBtn(1);

                // Titik-titik jika terlalu jauh dari 1
                if (currentPage > 4) {
                    const dots = document.createElement("button");
                    dots.textContent = "...";
                    dots.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                    dots.disabled = true;
                    paginationContainer.appendChild(dots);
                }

                // Tampilkan halaman di sekitar currentPage
                for (let i = currentPage - 2; i <= currentPage + 2; i++) {
                    if (i > 1 && i < totalPages) {
                        createPageBtn(i);
                    }
                }

                // Titik-titik jika terlalu jauh dari totalPages
                if (currentPage < totalPages - 3) {
                    const dots = document.createElement("button");
                    dots.textContent = "...";
                    dots.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                    dots.disabled = true;
                    paginationContainer.appendChild(dots);
                }

                // Tampilkan halaman terakhir jika totalPages > 1
                if (totalPages > 1) {
                    createPageBtn(totalPages);
                }

                // Tombol Next
                const nextBtn = document.createElement("button");
                nextBtn.innerHTML = `<img src="./assets/icons/chev-r-black.png" class="size-3 object-contain" />`;
                nextBtn.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                nextBtn.disabled = currentPage === totalPages;
                if (currentPage < totalPages) {
                    nextBtn.onclick = () => loadCampaigns(currentPage + 1);
                }
                paginationContainer.appendChild(nextBtn);
            }

            } catch (err) {
            campaignsContainer.innerHTML = "<p class='col-span-3 text-center text-red-500'>Gagal memuat kampanye.</p>";
            }
        }

        loadCampaigns();
    </script>


</body>

</html>