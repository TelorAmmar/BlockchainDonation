<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">
        body {
            @apply text-[#1E1E1E] bg-[#F8F9FA];
        }
    </style>
</head>

<body>
    <div class="h-screen flex flex-col">
        <!-- HEADER -->
        <div class="h-[139px] flex items-center justify-between px-20">
            <!-- LOGO -->
            <a href="/">
                <svg width="60" height="60" viewBox="0 0 44 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M23.6436 2.4659C25.8258 0.894708 28.3571 0.109111 31.2159 0.109111C32.787 0.109111 34.511 0.523732 36.3877 1.39662C38.2644 2.24768 39.7483 3.2515 40.8394 4.40807C43.0871 7.20131 44.0255 10.4528 43.6981 14.1626C43.349 17.8723 42.1269 20.7747 40.0102 22.826L23.4472 39.389C23.0325 39.8036 22.5088 40 21.8978 40C21.2868 40 20.7849 39.8036 20.3702 39.389C20.1685 39.1903 20.01 38.952 19.9049 38.6891C19.7997 38.4263 19.7501 38.1444 19.7592 37.8614C19.7592 37.2504 19.9556 36.7267 20.3702 36.3121L30.3866 26.2957C30.9322 25.8156 30.9322 25.3137 30.3866 24.7681C29.8411 24.2226 29.3391 24.2226 28.8591 24.7681L18.8427 34.7845C18.6407 34.9879 18.3987 35.1473 18.1321 35.2525C17.8654 35.3576 17.5798 35.4063 17.2933 35.3955C16.6823 35.3955 16.1804 35.1991 15.7658 34.7845C15.564 34.5858 15.4056 34.3476 15.3004 34.0847C15.1953 33.8218 15.1457 33.54 15.1548 33.257C15.1548 32.6459 15.3512 32.1222 15.7658 31.7076L25.7821 21.6912C26.3713 21.1457 26.3713 20.6001 25.7821 20.0546C25.2802 19.509 24.8001 19.509 24.2546 20.0546L14.2382 30.18C14.034 30.3803 13.7916 30.5376 13.5255 30.6426C13.2593 30.7475 12.9748 30.798 12.6888 30.7911C12.0778 30.7911 11.5541 30.5947 11.0958 30.18C10.6594 29.7654 10.4412 29.2635 10.4412 28.6525C10.4412 28.0415 10.6812 27.4959 11.1613 27.0158L21.1995 16.9776C21.745 16.4321 21.745 15.9302 21.1995 15.4501C20.6539 14.97 20.1302 14.97 19.6501 15.4501L9.52464 25.5101C9.04455 25.9465 8.54264 26.1866 7.99709 26.1866C7.38607 26.1866 6.86234 25.9684 6.46954 25.5101C6.05492 25.0737 5.8367 24.5499 5.8367 23.9389C5.8367 23.3279 6.05492 22.826 6.46954 22.4113C13.1471 15.6901 17.2715 11.6312 18.8427 10.1255L26.6114 17.8069C27.4624 18.6143 28.4444 19.0289 29.6447 19.0289C31.1722 19.0289 32.3724 18.4179 33.2671 17.1959C33.8782 16.3011 34.0964 15.3191 33.9218 14.228C33.7472 13.1369 33.289 12.2204 32.547 11.4566L23.6436 2.4659ZM28.1389 16.2793L18.8427 6.96127L3.39261 22.4113C1.55955 20.5565 0.512091 17.7196 0.272047 13.8571C0.0320038 10.0164 1.07947 6.67758 3.39261 3.88434C5.98945 1.30933 9.08819 0 12.6888 0C16.3113 0 19.3882 1.30933 21.8978 3.88434L31.2159 13.2024C31.6305 13.617 31.8269 14.1189 31.8269 14.73C31.8269 15.341 31.6305 15.8647 31.2159 16.2793C30.8012 16.6721 30.2993 16.8903 29.6447 16.8903C29.0555 16.8903 28.5536 16.6721 28.1389 16.2793Z"
                        fill="#1F7D53" />
                </svg>
            </a>

            <!-- NAVIGATION -->
            <div class="flex justify-between items-center gap-x-[97px]">
                <div class="flex justify-between gap-x-[21px]">
                    <a href="/" class="font-bold text-[#196442]">Beranda</a>
                    <a href="donation.html">Donasi</a>
                    <a href="#">Tentang Kami</a>
                </div>

                <div id="auth-buttons" class="flex justify-between gap-x-[21px] items-center">
                    <a href="login" id="login-button">Masuk</a>
                    <a href="register" id="register-button" class="bg-[#1F7D53] text-white rounded-xl px-5 py-3">Daftar</a>
                </div>
            </div>
        </div>

        <!-- HERO -->
        <div class="flex-1 relative">
            <div class="absolute h-full w-full inset-0 -z-10">
                <img src="./assets/images/donation-bg.png" class="h-full w-full" />
            </div>
            <div class="absolute h-full w-full inset-0 -z-5 bg-[#E9F2EE] opacity-88"></div>

            <div class="h-full w-full flex flex-col items-center justify-center gap-y-10">
                <h1 class="font-bold text-5xl">Mau berbagi apa hari ini?</h1>
                <img src="./assets/vectors/hero-1.png" />
                <p>Saatnya berbagi kebaikan dengan program-program di bawah ini</p>
            </div>
        </div>
    </div>

    <!-- DONATION SECTION -->
    <div class="px-20 py-14 space-y-10">
    <h1 class="text-5xl font-bold text-center">Daftar Semua Kampanye</h1>
        <div class="grid grid-cols-3 gap-10" id="all-campaigns">
            <!-- Campaign cards akan dimuat dari API -->
        </div>
        <div id="pagination" class="flex gap-2 justify-center mt-6"></div>
    </div>

    <!-- FOOTER -->
    <div class="bg-[#0B2C1D] px-20 py-14 space-y-16 text-white">
        <div class="flex justify-between">
            <div class="space-y-5">
                <h1 class="font-bold text-5xl text-[#1F7D53]">
                    Logo
                </h1>
                <p>Subscribe untuk mendapatkan info terbaru kami</p>
                <div class="rounded-full border border-white p-3 flex justify-between">
                    <input type="text" placeholder="Masukkan Email" class="flex-1">
                    <div class="size-7 flex items-center justify-center rounded-full bg-[#1F7D53]">
                        <img src="./assets/icons/arrow-right.png">
                    </div>
                </div>
            </div>

            <div class="gap-y-3 flex flex-col">
                <p>Dukungan</p>
                <a href="#" class="text-[#8E98A8]">FAQ & Privacy Policy</a>
                <a href="#" class="text-[#8E98A8]">Tentang</a>
                <a href="#" class="text-[#8E98A8]">Hubungi Kami</a>
                <a href="#" class="text-[#8E98A8]">Partner Kami</a>
            </div>
        </div>
        <p class="text-center">Â© 2025 Blockchain Donation Inc. Copyright and rights reserved</p>
    </div>

    <script>
        const campaignsContainer = document.getElementById("all-campaigns");
        const paginationContainer = document.getElementById("pagination");

        let currentPage = 1;
        const limitPerPage = 9;

        async function loadCampaigns(page = 1) {
            try {
            const res = await fetch(`/api/campaigns?page=${page}&limit=${limitPerPage}`);
            const data = await res.json();
            const { campaigns, totalPages } = data;

            campaignsContainer.innerHTML = "";
            renderPagination(page, totalPages);
            currentPage = page;

            if (campaigns.length === 0) {
                campaignsContainer.innerHTML = "<p class='col-span-3 text-center text-gray-500'>Belum ada kampanye.</p>";
                return;
            }

            campaigns.forEach(c => {
                const div = document.createElement("div");
                div.className = "rounded-xl bg-white flex flex-col";
                div.innerHTML = `
                <img src="${c.imageUrl || '/assets/images/donation-banner.png'}" class="rounded-t-xl" />
                <div class="p-4 space-y-3">
                    <h3 class="font-bold text-xl">${c.title}</h3>
                    <div class="flex gap-x-2 items-center">
                        <p class="text-[#8E98A8]">${c.organization ?? 'Lembaga Donasi'}</p>
                        <img src="/assets/vectors/verified.png" class="size-3">
                    </div>
                    <div class="flex gap-x-2">
                        <p class="font-bold text-xl text-[#1F7D53]">Rp. ${Number(c.collectedAmount).toLocaleString()}</p>
                        <p class="text-[#8E98A8]">Terkumpul</p>
                    </div>
                    <a href="/donation-detail.html?id=${c.id}" class="block w-min whitespace-nowrap bg-[#1F7D53] text-white rounded-xl px-5 py-3">Donasi</a>
                </div>
                `;
                campaignsContainer.appendChild(div);
            });

            // Render pagination buttons
            function renderPagination(currentPage, totalPages) {
                paginationContainer.innerHTML = "";

                // Tombol Previous
                const prevBtn = document.createElement("button");
                prevBtn.innerHTML = `<img src="./assets/icons/chev-l-grey.png" class="size-3 object-contain" />`;
                prevBtn.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                prevBtn.disabled = currentPage === 1;
                if (currentPage > 1) {
                    prevBtn.onclick = () => loadCampaigns(currentPage - 1);
                }
                paginationContainer.appendChild(prevBtn);

                // Fungsi bantu untuk membuat tombol
                const createPageBtn = (p) => {
                    const btn = document.createElement("button");
                    btn.textContent = p;
                    btn.className = `size-10 flex items-center justify-center rounded-xl ${
                        p === currentPage ? "bg-[#1F7D53] text-white" : "bg-white"
                    }`;
                    btn.onclick = () => loadCampaigns(p);
                    paginationContainer.appendChild(btn);
                };

                // Tampilkan halaman 1
                createPageBtn(1);

                // Titik-titik jika terlalu jauh dari 1
                if (currentPage > 4) {
                    const dots = document.createElement("button");
                    dots.textContent = "...";
                    dots.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                    dots.disabled = true;
                    paginationContainer.appendChild(dots);
                }

                // Tampilkan halaman di sekitar currentPage
                for (let i = currentPage - 2; i <= currentPage + 2; i++) {
                    if (i > 1 && i < totalPages) {
                        createPageBtn(i);
                    }
                }

                // Titik-titik jika terlalu jauh dari totalPages
                if (currentPage < totalPages - 3) {
                    const dots = document.createElement("button");
                    dots.textContent = "...";
                    dots.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                    dots.disabled = true;
                    paginationContainer.appendChild(dots);
                }

                // Tampilkan halaman terakhir jika totalPages > 1
                if (totalPages > 1) {
                    createPageBtn(totalPages);
                }

                // Tombol Next
                const nextBtn = document.createElement("button");
                nextBtn.innerHTML = `<img src="./assets/icons/chev-r-black.png" class="size-3 object-contain" />`;
                nextBtn.className = "size-10 flex items-center justify-center bg-white rounded-xl";
                nextBtn.disabled = currentPage === totalPages;
                if (currentPage < totalPages) {
                    nextBtn.onclick = () => loadCampaigns(currentPage + 1);
                }
                paginationContainer.appendChild(nextBtn);
            }

            } catch (err) {
            campaignsContainer.innerHTML = "<p class='col-span-3 text-center text-red-500'>Gagal memuat kampanye.</p>";
            }

            const token = localStorage.getItem("token");

            const loginBtn = document.getElementById("login-button");
            const registerBtn = document.getElementById("register-button");
            const authContainer = document.getElementById("auth-buttons");

            if (token) {
                authContainer.innerHTML = `
                    <div id="auth-buttons" class="flex justify-between gap-x-[21px] items-center">
                        <button id="logout-button" class="bg-red-600 text-white px-4 py-2 rounded-xl">Keluar</button>
                        <a href="dashboard" id="dashboard-button" class="bg-[#1F7D53] text-white rounded-xl px-5 py-3">Dashboard</a>
                    </div>
                `;

                document.getElementById("logout-button").addEventListener("click", () => {
                localStorage.removeItem("token");
                window.location.reload();
                });
            }
        }

        loadCampaigns();
    </script>


</body>

</html>