<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">
        body {
            @apply text-[#1E1E1E] bg-[#F8F9FA];
        }
    </style>
</head>

<body>
    <div class="grid grid-cols-12 h-screen w-screen">
        <!-- SIDEBAR -->
        <div class="col-span-3 p-10 space-y-10">
            <h1 class="font-bold text-5xl text-[#1F7D53]">
                Logo
            </h1>
            <hr class="text-gray-200">
            <div class="space-y-5">
                <a href="#" id="btn-dashboard" class="bg-white rounded-xl p-4 flex gap-x-3 items-center w-full">
                    <div class="rounded-xl size-10 flex items-center justify-center bg-[#1F7D53]">
                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M14.3041 5.53932C14.2227 5.46144 14.1143 5.41797 14.0017 5.41797C13.889 5.41797 13.7807 5.46144 13.6992 5.53932L3.63127 15.1572C3.58851 15.1981 3.5545 15.2473 3.53128 15.3017C3.50806 15.3561 3.49613 15.4147 3.49619 15.4739L3.49455 24.5006C3.49455 24.9647 3.67893 25.4098 4.00712 25.738C4.3353 26.0662 4.78042 26.2506 5.24455 26.2506H10.5C10.7321 26.2506 10.9546 26.1584 11.1187 25.9943C11.2828 25.8302 11.375 25.6076 11.375 25.3756V17.9381C11.375 17.822 11.4211 17.7108 11.5032 17.6287C11.5852 17.5467 11.6965 17.5006 11.8125 17.5006H16.1875C16.3035 17.5006 16.4148 17.5467 16.4969 17.6287C16.5789 17.7108 16.625 17.822 16.625 17.9381V25.3756C16.625 25.6076 16.7172 25.8302 16.8813 25.9943C17.0454 26.1584 17.268 26.2506 17.5 26.2506H22.7533C23.2174 26.2506 23.6625 26.0662 23.9907 25.738C24.3189 25.4098 24.5033 24.9647 24.5033 24.5006V15.4739C24.5034 15.4147 24.4914 15.3561 24.4682 15.3017C24.445 15.2473 24.411 15.1981 24.3682 15.1572L14.3041 5.53932Z"
                                fill="white" />
                            <path
                                d="M26.8473 13.3539L22.7567 9.44047V3.50195C22.7567 3.26989 22.6645 3.04733 22.5004 2.88323C22.3363 2.71914 22.1137 2.62695 21.8817 2.62695H19.2567C19.0246 2.62695 18.8021 2.71914 18.638 2.88323C18.4739 3.04733 18.3817 3.26989 18.3817 3.50195V5.25195L15.2142 2.22336C14.9178 1.92367 14.477 1.75195 14.0007 1.75195C13.526 1.75195 13.0863 1.92367 12.7899 2.22391L1.15786 13.3528C0.817701 13.6809 0.775044 14.2207 1.08458 14.5762C1.1623 14.6659 1.25748 14.7389 1.3643 14.7906C1.47113 14.8424 1.58737 14.8719 1.70596 14.8773C1.82454 14.8828 1.94299 14.864 2.0541 14.8222C2.1652 14.7804 2.26664 14.7164 2.35223 14.6341L13.6999 3.7907C13.7813 3.71282 13.8896 3.66935 14.0023 3.66935C14.115 3.66935 14.2233 3.71282 14.3047 3.7907L25.6535 14.6341C25.8206 14.7945 26.0446 14.8819 26.2761 14.8774C26.5077 14.8729 26.7281 14.7768 26.8889 14.6101C27.2246 14.2623 27.1968 13.688 26.8473 13.3539Z"
                                fill="white" />
                        </svg>
                    </div>
                    <p class="text-xl font-bold">Dashboard</p>
                </a>
                <a href="#" id="btn-riwayat" class="rounded-xl p-4 flex gap-x-3 items-center w-full">
                    <div class="rounded-xl size-10 flex items-center justify-center bg-white">
                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M1.74991 20.5615C1.74991 21.3737 2.07256 22.1527 2.64689 22.727C3.22122 23.3014 4.00018 23.624 4.81241 23.624H23.1874C23.9996 23.624 24.7786 23.3014 25.3529 22.727C25.9272 22.1527 26.2499 21.3737 26.2499 20.5615V12.1396H1.74991V20.5615ZM5.35928 16.4053C5.35928 15.9702 5.53213 15.5529 5.83981 15.2452C6.14749 14.9375 6.56479 14.7646 6.99991 14.7646H9.62491C10.06 14.7646 10.4773 14.9375 10.785 15.2452C11.0927 15.5529 11.2655 15.9702 11.2655 16.4053V17.499C11.2655 17.9341 11.0927 18.3514 10.785 18.6591C10.4773 18.9668 10.06 19.1396 9.62491 19.1396H6.99991C6.56479 19.1396 6.14749 18.9668 5.83981 18.6591C5.53213 18.3514 5.35928 17.9341 5.35928 17.499V16.4053Z"
                                fill="#1F7D53" />
                            <path
                                d="M23.1874 4.37354H4.81241C4.00018 4.37354 3.22122 4.69619 2.64689 5.27052C2.07256 5.84485 1.74991 6.62381 1.74991 7.43603V8.85791H26.2499V7.43603C26.2499 6.62381 25.9272 5.84485 25.3529 5.27052C24.7786 4.69619 23.9996 4.37354 23.1874 4.37354V4.37354Z"
                                fill="#1F7D53" />
                        </svg>
                    </div>
                    <p class="text-xl font-bold text-[#8E98A8]">Riwayat Donasi</p>
                </a>
                <a href="#" id="btn-logout" class="rounded-xl p-4 flex gap-x-3 items-center w-full">
                    <div class="rounded-xl size-10 flex items-center justify-center bg-white">
                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M19.8333 2.3335H8.16666C6.18333 2.3335 4.66666 3.85016 4.66666 5.8335V12.8335H14.7L12.0167 10.1502C11.55 9.6835 11.55 8.9835 12.0167 8.51683C12.4833 8.05016 13.1833 8.05016 13.65 8.51683L18.3167 13.1835C18.7833 13.6502 18.7833 14.3502 18.3167 14.8168L13.65 19.4835C13.1833 19.9502 12.4833 19.9502 12.0167 19.4835C11.55 19.0168 11.55 18.3168 12.0167 17.8502L14.7 15.1668H4.66666V22.1668C4.66666 24.1502 6.18333 25.6668 8.16666 25.6668H19.8333C21.8167 25.6668 23.3333 24.1502 23.3333 22.1668V5.8335C23.3333 3.85016 21.8167 2.3335 19.8333 2.3335Z"
                                fill="#1F7D53" />
                        </svg>
                    </div>
                    <p class="text-xl font-bold text-[#8E98A8]">Keluar</p>
                </a>
            </div>
        </div>


        <div class="col-span-9 p-10 gap-y-6 flex flex-col">
            <div id="dashboard-section" class="space-y-8">
                <!-- Konten Dashboard & Donasi Terbaru dari dashboard.html -->
                 <h1 class="font-bold">Dashboard</h1>

                <div class="grid grid-cols-2 gap-x-5">
                    <div class="flex gap-x-3 items-center bg-white rounded-xl p-3">
                        <div class="bg-[#1F7D53] size-12 p-2 rounded-xl flex items-center justify-center">
                            <svg width="44" height="40" viewBox="0 0 44 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M23.6436 2.4659C25.8258 0.894708 28.3571 0.109111 31.2159 0.109111C32.787 0.109111 34.511 0.523732 36.3877 1.39662C38.2644 2.24768 39.7483 3.2515 40.8394 4.40807C43.0871 7.20131 44.0255 10.4528 43.6981 14.1626C43.349 17.8723 42.1269 20.7747 40.0102 22.826L23.4472 39.389C23.0325 39.8036 22.5088 40 21.8978 40C21.2868 40 20.7849 39.8036 20.3702 39.389C20.1685 39.1903 20.01 38.952 19.9049 38.6891C19.7997 38.4263 19.7501 38.1444 19.7592 37.8614C19.7592 37.2504 19.9556 36.7267 20.3702 36.3121L30.3866 26.2957C30.9322 25.8156 30.9322 25.3137 30.3866 24.7681C29.8411 24.2226 29.3391 24.2226 28.8591 24.7681L18.8427 34.7845C18.6407 34.9879 18.3987 35.1473 18.1321 35.2525C17.8654 35.3576 17.5798 35.4063 17.2933 35.3955C16.6823 35.3955 16.1804 35.1991 15.7658 34.7845C15.564 34.5858 15.4056 34.3476 15.3004 34.0847C15.1953 33.8218 15.1457 33.54 15.1548 33.257C15.1548 32.6459 15.3512 32.1222 15.7658 31.7076L25.7821 21.6912C26.3713 21.1457 26.3713 20.6001 25.7821 20.0546C25.2802 19.509 24.8001 19.509 24.2546 20.0546L14.2382 30.18C14.034 30.3803 13.7916 30.5376 13.5255 30.6426C13.2593 30.7475 12.9748 30.798 12.6888 30.7911C12.0778 30.7911 11.5541 30.5947 11.0958 30.18C10.6594 29.7654 10.4412 29.2635 10.4412 28.6525C10.4412 28.0415 10.6812 27.4959 11.1613 27.0158L21.1995 16.9776C21.745 16.4321 21.745 15.9302 21.1995 15.4501C20.6539 14.97 20.1302 14.97 19.6501 15.4501L9.52464 25.5101C9.04455 25.9465 8.54264 26.1866 7.99709 26.1866C7.38607 26.1866 6.86234 25.9684 6.46954 25.5101C6.05492 25.0737 5.8367 24.5499 5.8367 23.9389C5.8367 23.3279 6.05492 22.826 6.46954 22.4113C13.1471 15.6901 17.2715 11.6312 18.8427 10.1255L26.6114 17.8069C27.4624 18.6143 28.4444 19.0289 29.6447 19.0289C31.1722 19.0289 32.3724 18.4179 33.2671 17.1959C33.8782 16.3011 34.0964 15.3191 33.9218 14.228C33.7472 13.1369 33.289 12.2204 32.547 11.4566L23.6436 2.4659ZM28.1389 16.2793L18.8427 6.96127L3.39261 22.4113C1.55955 20.5565 0.512091 17.7196 0.272047 13.8571C0.0320038 10.0164 1.07947 6.67758 3.39261 3.88434C5.98945 1.30933 9.08819 0 12.6888 0C16.3113 0 19.3882 1.30933 21.8978 3.88434L31.2159 13.2024C31.6305 13.617 31.8269 14.1189 31.8269 14.73C31.8269 15.341 31.6305 15.8647 31.2159 16.2793C30.8012 16.6721 30.2993 16.8903 29.6447 16.8903C29.0555 16.8903 28.5536 16.6721 28.1389 16.2793Z"
                                    fill="white" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-[#8E98A8]">Jumlah Donasi</p>
                            <p class="font-bold text-xl" data-jumlah-donasi>0</p>
                        </div>
                    </div>

                    <div class="flex gap-x-3 items-center bg-white rounded-xl p-3">
                        <div class="bg-[#1F7D53] size-12 p-2 rounded-xl flex items-center justify-center">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M7.46079 8.12113H32.4608C32.7528 8.12099 33.0446 8.13952 33.3342 8.1766C33.236 7.48736 32.9993 6.82514 32.6383 6.22987C32.2772 5.6346 31.7994 5.11861 31.2335 4.71301C30.6677 4.3074 30.0256 4.02059 29.3459 3.86986C28.6662 3.71913 27.963 3.7076 27.2788 3.83597L6.7186 7.34613H6.69517C5.4046 7.59292 4.25693 8.3231 3.48657 9.38753C4.64719 8.56201 6.03652 8.11929 7.46079 8.12113Z"
                                    fill="white" />
                                <path
                                    d="M32.4611 10H7.46106C6.13542 10.0014 4.86449 10.5287 3.92712 11.4661C2.98976 12.4034 2.46251 13.6744 2.46106 15V30C2.46251 31.3256 2.98976 32.5966 3.92712 33.5339C4.86449 34.4713 6.13542 34.9985 7.46106 35H32.4611C33.7867 34.9985 35.0576 34.4713 35.995 33.5339C36.9324 32.5966 37.4596 31.3256 37.461 30V15C37.4596 13.6744 36.9324 12.4034 35.995 11.4661C35.0576 10.5287 33.7867 10.0014 32.4611 10ZM28.7501 25C28.2557 25 27.7723 24.8534 27.3612 24.5787C26.9501 24.304 26.6296 23.9135 26.4404 23.4567C26.2512 22.9999 26.2017 22.4972 26.2982 22.0123C26.3946 21.5273 26.6327 21.0819 26.9823 20.7322C27.332 20.3826 27.7774 20.1445 28.2624 20.048C28.7473 19.9516 29.25 20.0011 29.7068 20.1903C30.1636 20.3795 30.5541 20.6999 30.8288 21.1111C31.1035 21.5222 31.2501 22.0055 31.2501 22.5C31.2501 23.163 30.9867 23.7989 30.5179 24.2678C30.049 24.7366 29.4132 25 28.7501 25Z"
                                    fill="white" />
                                <path
                                    d="M2.5 20.269V12.4956C2.5 10.8026 3.4375 7.96435 6.69141 7.34951C9.45312 6.83154 12.1875 6.83154 12.1875 6.83154C12.1875 6.83154 13.9844 8.08154 12.5 8.08154C11.0156 8.08154 11.0547 9.9956 12.5 9.9956C13.9453 9.9956 12.5 11.8315 12.5 11.8315L6.67969 18.4331L2.5 20.269Z"
                                    fill="white" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-[#8E98A8]">Jumlah Dana Didonasikan</p>
                            <p class="font-bold text-xl" data-total-donasi>Rp 0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white flex-1 rounded-xl p-5 space-y-5 flex flex-col">
                    <div class="flex justify-between items-center">
                        <p class="font-bold">Donasi Terbaru</p>
                        <a href="#" class="text-[#1F7D53]">Lihat Semua</a>
                    </div>
                    <div class="overflow-y-auto grow h-200">
                        <table class="w-full border-collapse">
                            <thead class="text-sm text-[#8E98A8] font-thin text-left">
                                <tr class="border-b border-gray-300">
                                    <th class="py-3">Nama Program</th>
                                    <th class="py-3">Nominal Donasi (Rp)</th>
                                    <th class="py-3">Tanggal Donasi</th>
                                </tr>
                            </thead>
                            <tbody id="donasi-terbaru-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="riwayat-section" style="display:none;" class="space-y-8">
                <!-- Konten Riwayat Donasi dari dashboard2.html -->
                 <h1 class="font-bold">Riwayat Donasi</h1>

                <div class="bg-white flex-1 rounded-xl p-5 space-y-8 flex flex-col">
                    <div class="flex justify-end items-center">
                        <a href="#" class="text-[#1F7D53]">Filter</a>
                    </div>
                    <div class="overflow-y-auto grow h-200">
                        <table class="w-full border-collapse">
                            <thead class="text-sm text-[#8E98A8] font-thin text-left">
                                <tr class="border-b border-gray-300">
                                    <th class="py-3">Nama Program</th>
                                    <th class="py-3">Nominal Donasi (Rp)</th>
                                    <th class="py-3">Status Pembayaran</th>
                                    <th class="py-3">Tanggal Donasi</th>
                                    <th class="py-3">Invoice</th>
                                </tr>
                            </thead>
                            <tbody id="riwayat-donasi-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            

            <p class="text-[#8E98A8] text-center text-sm">© 2025 Blockchain Donation Inc. Copyright and rights reserved
            </p>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            const token = localStorage.getItem("token");
            if (!token) {
                window.location.href = "/login";
                return;
            }

            try {
                const res = await fetch("/api/dashboard", {
                    headers: {
                        "Authorization": "Bearer " + token
                    }
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.message || "Gagal memuat dashboard");

                // Update jumlah donasi dan dana didonasikan
                const jumlahDonasi = data.data.donations.length;
                const totalDonasi = data.data.donations.reduce((sum, d) => sum + d.amount, 0);

                document.querySelector('[data-jumlah-donasi]').textContent = jumlahDonasi;
                document.querySelector('[data-total-donasi]').textContent = "Rp " + totalDonasi.toLocaleString();

                // Tampilkan donasi terbaru
                const tbody = document.getElementById("donasi-terbaru-tbody");
                tbody.innerHTML = "";
                data.data.donations.slice(0, 10).forEach(donasi => {
                    const tr = document.createElement("tr");
                    tr.className = "border-b border-gray-300";
                    tr.innerHTML = `
                        <td class="py-3">${donasi.campaign.title}</td>
                        <td class="py-3">${donasi.amount.toLocaleString()}</td>
                        <td class="py-3">${new Date(donasi.createdAt).toLocaleDateString("id-ID", { day: "2-digit", month: "long", year: "numeric" })}</td>
                    `;
                    tbody.appendChild(tr);
                });

                // Tampilkan riwayat donasi
                const tbodyRiwayat = document.getElementById("riwayat-donasi-tbody");
                tbodyRiwayat.innerHTML = "";
                data.data.donations.forEach(donasi => {
                    const tr = document.createElement("tr");
                    tr.className = "border-b border-gray-300";
                    tr.innerHTML = `
                        <td class="py-3">${donasi.campaign.title}</td>
                        <td class="py-3">${donasi.amount.toLocaleString()}</td>
                        <td class="py-3">
                            <p class="bg-[#1F7D53] text-white py-1 px-2 rounded-xl w-min whitespace-nowrap text-sm">
                                Terkonfirmasi
                            </p>
                        </td>
                        <td class="py-3">${new Date(donasi.createdAt).toLocaleDateString("id-ID", { day: "2-digit", month: "long", year: "numeric" })}</td>
                        <td class="py-3 flex gap-x-2 items-center">
                            <svg width="30" height="30" viewBox="0 0 30 30" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M15 2.5V10.625C15 11.1223 15.1975 11.5992 15.5492 11.9508C15.9008 12.3025 16.3777 12.5 16.875 12.5H25V25C25 25.663 24.7366 26.2989 24.2678 26.7678C23.7989 27.2366 23.163 27.5 22.5 27.5H7.5C6.83696 27.5 6.20107 27.2366 5.73223 26.7678C5.26339 26.2989 5 25.663 5 25V5C5 4.33696 5.26339 3.70107 5.73223 3.23223C6.20107 2.76339 6.83696 2.5 7.5 2.5H15ZM13.7638 14.81C13.4645 16.7138 12.4689 18.4387 10.97 19.65C9.86125 20.545 10.875 22.3012 12.205 21.79C14.0035 21.0973 15.9952 21.0973 17.7937 21.79C19.1237 22.3025 20.1375 20.5462 19.0287 19.65C17.5298 18.4387 16.5342 16.7138 16.235 14.81C16.0138 13.4025 13.985 13.4012 13.7638 14.81ZM15 17.8788L16.0075 19.6213H13.995L15 17.8788ZM17.5 2.55375C17.9736 2.65419 18.4078 2.88999 18.75 3.2325L24.2675 8.75C24.61 9.09216 24.8458 9.5264 24.9463 10H17.5V2.55375Z"
                                    fill="#1F7D53" />
                            </svg>
                            <p>PDF</p>
                        </td>
                    `;
                    tbodyRiwayat.appendChild(tr);
                });

            } catch (err) {
                alert(err.message);
            }
        });
    </script>
    <script>
        document.getElementById('btn-dashboard').onclick = function(e) {
            e.preventDefault();
            document.getElementById('dashboard-section').style.display = '';
            document.getElementById('riwayat-section').style.display = 'none';

            // Aktifkan tombol Dashboard, nonaktifkan Riwayat
            document.getElementById('btn-dashboard').classList.add('bg-white');
            document.getElementById('btn-dashboard').classList.remove('bg-transparent');
            document.getElementById('btn-riwayat').classList.remove('bg-white');
            document.getElementById('btn-riwayat').classList.add('bg-transparent');
        };
        document.getElementById('btn-riwayat').onclick = function(e) {
            e.preventDefault();
            document.getElementById('dashboard-section').style.display = 'none';
            document.getElementById('riwayat-section').style.display = '';

            // Aktifkan tombol Riwayat, nonaktifkan Dashboard
            document.getElementById('btn-riwayat').classList.add('bg-white');
            document.getElementById('btn-riwayat').classList.remove('bg-transparent');
            document.getElementById('btn-dashboard').classList.remove('bg-white');
            document.getElementById('btn-dashboard').classList.add('bg-transparent');
        };
        document.getElementById('btn-logout').onclick = function(e) {
            e.preventDefault();
            localStorage.removeItem('token');
            window.location.href = '/login';
        };
    </script>
</body>

</html>